<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="berber_randevu_uygulamasi.Views.BerberRandevularSayfasi"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:models="clr-namespace:berber_randevu_uygulamasi.Models"
    xmlns:altbar="clr-namespace:berber_randevu_uygulamasi.Views.AltBarlar"
    Title="Randevular"
    BackgroundColor="#0F0F0F">

    <Grid RowDefinitions="Auto,Auto,*,Auto">

        <!-- Başlık -->
        <Grid Padding="12,10" ColumnDefinitions="*,Auto">
            <Label Text="Randevular" FontSize="20" FontAttributes="Bold" TextColor="#F2F2F2"/>
            <Button Grid.Column="1" Text="Yenile" Clicked="Yenile_Clicked"/>
        </Grid>

        <!-- Segment -->
        <Grid Grid.Row="1" Padding="12,0" ColumnDefinitions="*,*">
            <Button x:Name="btnGelecek" Text="Gelecek" Clicked="Gelecek_Clicked"/>
            <Button x:Name="btnGecmis" Grid.Column="1" Text="Geçmiş" Clicked="Gecmis_Clicked"/>
        </Grid>

        <!-- Listeler -->
        <Grid Grid.Row="2">

            <!-- Gelecek -->
            <CollectionView x:Name="listeGelecek">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:RandevuKart">
                        <Border BackgroundColor="#1A1A1A"
                                Stroke="#2B2B2B"
                                StrokeShape="RoundRectangle 18"
                                Padding="14"
                                Margin="12,8">

                            <Grid ColumnDefinitions="Auto,*,Auto" RowDefinitions="Auto,Auto">

                                <!-- SOL: Saat -->
                                <Label Grid.Column="0"
                                  Text="{Binding SaatText}"
                                  FontSize="22"
                                  FontAttributes="Bold"
                                  TextColor="#F2F2F2"
                                  VerticalOptions="Center"
                                  Margin="0,0,12,0"/>

                                <!-- ORTA: Foto + Bilgiler -->
                                <Grid Grid.Column="1" ColumnDefinitions="Auto,*" RowDefinitions="Auto">
                                    <!-- Foto -->
                                    <Border BackgroundColor="#232323"
                                            StrokeShape="RoundRectangle 14"
                                            WidthRequest="80"
                                            HeightRequest="80"
                                            VerticalOptions="Start">
                                        <Image Source="{Binding MusteriFoto}"
                                               Aspect="AspectFill"/>
                                    </Border>

                                    <!-- Bilgiler -->
                                    <VerticalStackLayout Grid.Column="1" Margin="10,0,0,0" Spacing="2">
                                        <Label Text="{Binding MusteriAdSoyad}"
                                          FontAttributes="Bold"
                                          TextColor="#F2F2F2"/>

                                        <Label Text="{Binding HizmetAdi}"
                                                     FontSize="12"
                                                     TextColor="#BDBDBD"/>

                                        <Label Text="{Binding TarihText}"
                                               FontSize="12"
                                               TextColor="#BDBDBD"/>
                                    </VerticalStackLayout>
                                </Grid>

                                <!-- SAĞ: Fiyat -->
                                <Label Grid.Column="2"
                                  Text="{Binding ToplamUcret, StringFormat='{0:0} ₺'}"
                                  FontAttributes="Bold"
                                  FontSize="28"
                                  TextColor="#F2F2F2"
                                  HorizontalTextAlignment="End"
                                  VerticalOptions="Center"/>

                                <!-- ALT: Butonlar -->
                                <Grid Grid.Row="1" Grid.ColumnSpan="3" ColumnDefinitions="*,*" ColumnSpacing="10" Margin="0,12,0,0">
                                    <Button Text="✔ Geldi" Clicked="Geldi_Clicked" CommandParameter="{Binding}"/>
                                    <Button Grid.Column="1" Text="❌ Gelmedi" Clicked="Gelmedi_Clicked" CommandParameter="{Binding}"/>
                                </Grid>

                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <!-- Geçmiş -->
            <CollectionView x:Name="listeGecmis" IsVisible="False">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:RandevuKart">
                        <Border BackgroundColor="#1A1A1A"
                                Stroke="#2B2B2B"
                                StrokeShape="RoundRectangle 18"
                                Padding="14"
                                Margin="12,8">

                            <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto">
                                <Label Text="{Binding SaatText}"
                                       FontSize="18"
                                       FontAttributes="Bold"
                                       TextColor="#F2F2F2"/>

                                <Grid Grid.Column="1" ColumnDefinitions="Auto,*" Margin="12,0,0,0">
                                    <Border BackgroundColor="#232323"
                                            StrokeShape="RoundRectangle 14"
                                            WidthRequest="44"
                                            HeightRequest="44">
                                        <Image Source="{Binding MusteriFoto}" Aspect="AspectFill"/>
                                    </Border>

                                    <VerticalStackLayout Grid.Column="1" Margin="10,0,0,0" Spacing="2">
                                        <Label Text="{Binding MusteriAdSoyad}" FontAttributes="Bold" TextColor="#F2F2F2"/>
                                        <Label Text="{Binding HizmetAdi}" FontSize="12" TextColor="#BDBDBD"/>
                                        <Label Text="{Binding DurumText}" FontSize="12" TextColor="#BDBDBD"/>
                                    </VerticalStackLayout>
                                </Grid>

                                <Label Grid.Row="1" Grid.ColumnSpan="2"
                                       Text="{Binding TarihText}"
                                       FontSize="12"
                                       TextColor="#BDBDBD"
                                       Margin="0,10,0,0"/>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

        </Grid>

        <altbar:BerberAltBar Grid.Row="3"/>
    </Grid>
</ContentPage>